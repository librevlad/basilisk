# OWASP Juice Shop scan config
# Usage: .venv/Scripts/python.exe -m basilisk audit 127.0.0.1:3000 --config config/juiceshop.yaml -v
# Docker: docker-compose -f docker-compose.juiceshop.yml up -d

http:
  timeout: 15.0
  verify_ssl: false

rate_limit:
  requests_per_second: 50.0
  burst: 10

scan:
  scan_paths:
    # ── SQLi targets ─────────────────────────────────────────────────
    - /rest/products/search?q=test
    - /rest/user/login?email=test@test.com&password=test

    # ── XSS targets ──────────────────────────────────────────────────
    - /rest/track-order/test
    - /#/track-result?id=test

    # ── NoSQL injection ──────────────────────────────────────────────
    - /rest/products/reviews?message=test
    - /rest/user/login?email=test&password=test

    # ── Open redirect ────────────────────────────────────────────────
    - /redirect?to=https://owasp.org

    # ── REST API (access control, info disclosure) ───────────────────
    - /api/Products?d=test
    - /api/Feedbacks?comment=test&rating=5
    - /api/Users?id=1
    - /api/Challenges?name=test
    - /api/Quantitys?id=1
    - /api/SecurityQuestions?id=1
    - /api/SecurityAnswers?id=1
    - /api/Complaints?message=test
    - /api/Recycles?id=1
    - /api/Deliverys?id=1
    - /api/Cards?id=1
    - /api/Addresss?id=1

    # ── IDOR / business logic ────────────────────────────────────────
    - /rest/basket/1
    - /rest/basket/2
    - /rest/saveLoginIp
    - /rest/deluxe-membership

    # ── Admin / auth endpoints ───────────────────────────────────────
    - /rest/admin/application-version
    - /rest/admin/application-configuration

    # ── File access / info disclosure ────────────────────────────────
    - /ftp
    - /ftp?doc=package.json
    - /encryptionkeys
    - /support/logs
    - /assets/public/images/uploads/

    # ── Debug / API docs / monitoring ────────────────────────────────
    - /metrics
    - /api-docs
    - /snippets
    - /snippet

    # ── SSRF / file upload ───────────────────────────────────────────
    - /profile?imageUrl=https://example.com/test.png
    - /file-upload
    - /rest/memories
    - /video

    # ── XXE ──────────────────────────────────────────────────────────
    - /b2b/v2/orders

    # ── Chatbot ──────────────────────────────────────────────────────
    - /rest/chatbot/status
    - /rest/chatbot/respond?message=test

    # ── Misc ─────────────────────────────────────────────────────────
    - /promotion
    - /dataerasure

log_level: DEBUG
