name: vampi
description: "VAmPI - Vulnerable REST API"
target: "localhost:5000"
target_ports: [5000]
max_steps: 150
required_coverage: 1.0
docker:
  compose_file: docker-compose.vampi.yml
  service_name: vampi
  ready_url: "http://localhost:5000/"

auth:
  auth_type: json_api
  username: basilisk_user
  password: basilisk_pass123
  setup_url: /createdb
  register_url: /users/v1/register
  register_data:
    username: "basilisk-{uuid}"
    password: basilisk_pass123
    email: "basilisk-{uuid}@test.com"
  login_url: /users/v1/login
  login_fields:
    username: "basilisk-{uuid}"
    password: basilisk_pass123
  token_path: auth_token
  token_header: Authorization
  token_prefix: "Bearer "

scan_paths:
  - /
  - /createdb
  - /users/v1
  - /users/v1/_debug
  - /users/v1/register
  - /users/v1/login
  - /users/v1/1
  - /books/v1
  - /books/v1?book_title=test

expected_findings:
  - { title: "NoSQL Injection", severity: "critical", category: "injection", plugin_hints: ["nosqli_check"] }
  - { title: "IDOR", severity: "critical", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "Mass Assignment", severity: "critical", category: "auth", plugin_hints: ["param_tampering"] }
  - { title: "JWT", severity: "critical", category: "auth", plugin_hints: ["jwt_attack"] }
  - { title: "BOLA", severity: "high", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "Sensitive path", severity: "high", category: "config", plugin_hints: ["dir_brute"] }
  - { title: "User Enumeration", severity: "medium", category: "auth", plugin_hints: ["default_creds"] }
