name: dvws
description: "Damn Vulnerable Web Sockets - WebSocket security"
target: "localhost:4580"
target_ports: [4580]
max_steps: 200
required_coverage: 1.0

docker:
  compose_file: docker-compose.dvws.yml
  service_name: dvws
  ready_url: "http://localhost:4580/"

scan_paths:
  - /
  - /authenticate
  - /ws
  - /messages
  - /users
  - /profile
  - /search
  - /admin
  - /file-upload
  - /api/users
  - /api/messages

expected_findings:
  - { title: "Cross-Site WebSocket Hijacking", severity: "critical", category: "csrf", plugin_hints: ["csrf_check", "websocket_check"] }
  - { title: "SQL Injection via WebSocket", severity: "critical", category: "sqli", plugin_hints: ["sqli_basic"] }
  - { title: "Command Injection via WebSocket", severity: "critical", category: "injection", plugin_hints: ["command_injection"] }
  - { title: "Broken Authentication", severity: "high", category: "auth", plugin_hints: ["auth_bypass", "session_check"] }
  - { title: "XSS via WebSocket", severity: "high", category: "xss", plugin_hints: ["xss_basic", "xss_advanced"] }
  - { title: "IDOR", severity: "high", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "SSRF", severity: "high", category: "injection", plugin_hints: ["ssrf_check"] }
  - { title: "Sensitive Data Exposure", severity: "high", category: "config", plugin_hints: ["http_headers", "js_secret_scan"] }
  - { title: "Missing Rate Limiting", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
  - { title: "CORS Misconfiguration", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
