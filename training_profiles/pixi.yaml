name: pixi
description: "OWASP DevSlop Pixi"
target: "localhost:8000"
target_ports: [8000]
max_steps: 200
required_coverage: 1.0
docker:
  compose_file: docker-compose.pixi.yml
  service_name: pixi
  ready_url: "http://localhost:8000/"

auth:
  auth_type: json_api
  username: test@pixi.com
  password: test1234
  register_url: /api/user/register
  register_data:
    user: "pixi-{uuid}@test.com"
    pass: test1234
  login_url: /api/user/login
  login_fields:
    user: "pixi-{uuid}@test.com"
    pass: test1234
  token_path: token
  token_header: x-access-token
  token_prefix: ""

scan_paths:
  - /login
  - /register
  - /about
  - /api/user/login
  - /api/user/register
  - /api/user/info
  - /api/user/edit
  - /api/user/search?search=test
  - /api/picture/upload
  - /api/picture/
  - /api/picture/1
  - /api/user/1
  - /api/admin/users/1
  - /api/admin/users/search?search=test

expected_findings:
  - { title: "NoSQL Injection", severity: "critical", category: "injection", plugin_hints: ["nosqli_check"] }
  - { title: "IDOR", severity: "high", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "JWT", severity: "high", category: "auth", plugin_hints: ["jwt_attack"] }
  - { title: "Clickjacking", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
  - { title: "Missing security header", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
