name: vapi
description: "vAPI - Vulnerable Adversely Programmed Interface"
target: "localhost:4880"
target_ports: [4880]
max_steps: 150
required_coverage: 1.0

docker:
  compose_file: docker-compose.vapi.yml
  service_name: vapi
  ready_url: "http://localhost:4880/"

expected_findings:
  - { title: "Broken Authentication", severity: "critical", category: "auth", plugin_hints: ["default_creds", "jwt_attack"] }
  - { title: "Broken Function Level Authorization", severity: "critical", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "Mass Assignment", severity: "critical", category: "auth", plugin_hints: ["param_tampering"] }
  - { title: "SQL Injection API", severity: "critical", category: "sqli", plugin_hints: ["sqli_basic"] }
  - { title: "JWT Vulnerability", severity: "critical", category: "auth", plugin_hints: ["jwt_attack"] }
  - { title: "BOLA", severity: "high", category: "auth", plugin_hints: ["idor_check"] }
  - { title: "Excessive Data Exposure", severity: "high", category: "config", plugin_hints: ["dir_brute"] }
  - { title: "SSRF", severity: "high", category: "injection", plugin_hints: ["ssrf_check"] }
  - { title: "CORS Misconfiguration", severity: "medium", category: "config", plugin_hints: ["cors_scan"] }
  - { title: "Rate Limiting Missing", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
  - { title: "Security Misconfiguration", severity: "medium", category: "config", plugin_hints: ["http_headers"] }
  - { title: "Deprecated API Version", severity: "medium", category: "config", plugin_hints: ["dir_brute"] }
  - { title: "Insufficient Logging", severity: "low", category: "config", plugin_hints: ["http_headers"] }
