name: juice_shop
description: "OWASP Juice Shop"
target: "localhost:3000"
target_ports: [3000]
max_steps: 100
required_coverage: 1.0
docker:
  compose_file: docker-compose.juiceshop.yml
  service_name: juice-shop
  ready_url: "http://localhost:3000/"

auth:
  auth_type: json_api
  username: basilisk@test.com
  password: "Basilisk123!"
  register_url: /api/Users/
  register_data:
    email: "basilisk-{uuid}@test.com"
    password: "Basilisk123!"
    passwordRepeat: "Basilisk123!"
    securityAnswer: "test"
  login_url: /rest/user/login
  login_fields:
    email: "basilisk-{uuid}@test.com"
    password: "Basilisk123!"
  token_path: authentication.token
  token_header: Authorization
  token_prefix: "Bearer "

scan_paths:
  - /rest/products/search?q=test
  - /rest/user/login
  - /rest/user/change-password?current=test&new=test&repeat=test
  - /rest/user/reset-password
  - /rest/basket/1
  - /rest/products/1/reviews
  - /api/Feedbacks/
  - /api/Users/
  - /api/Complaints/
  - /api/Recycles/
  - /api/SecurityQuestions/
  - /api/Quantitys/
  - /ftp/
  - /encryptionkeys/
  - /support/logs
  - /#/score-board
  - /metrics
  - /api-docs/
  - /rest/admin/application-configuration
  - /rest/memories/
  - /b2b/v2/orders

expected_findings:
  - title: "SQL Injection Login Bypass"
    severity: "critical"
    category: "sqli"
    plugin_hints: ["sqli_basic"]
  - title: "SQL Injection User Credentials"
    severity: "critical"
    category: "sqli"
    plugin_hints: ["sqli_basic", "sqli_advanced"]
  - title: "NoSQL Injection"
    severity: "critical"
    category: "injection"
    plugin_hints: ["nosqli_check"]
  - title: "XXE Data Exfiltration"
    severity: "critical"
    category: "injection"
    plugin_hints: ["xxe_check"]
  - title: "Insecure Deserialization"
    severity: "critical"
    category: "injection"
    plugin_hints: ["deserialization_check"]
  - title: "Admin Login"
    severity: "critical"
    category: "auth"
    plugin_hints: ["default_creds", "sqli_basic"]
  - title: "Password Reset Exploit"
    severity: "high"
    category: "auth"
    plugin_hints: ["auth_bypass"]
  - title: "Two Factor Auth Bypass"
    severity: "high"
    category: "auth"
    plugin_hints: ["auth_bypass"]
  - title: "DOM XSS"
    severity: "high"
    category: "xss"
    plugin_hints: ["xss_dom"]
  - title: "Reflected XSS"
    severity: "high"
    category: "xss"
    plugin_hints: ["xss_basic"]
  - title: "Stored XSS"
    severity: "high"
    category: "xss"
    plugin_hints: ["xss_advanced"]
  - title: "Admin Section Access"
    severity: "high"
    category: "auth"
    plugin_hints: ["dir_brute", "idor_check"]
  - title: "View Another User Basket"
    severity: "high"
    category: "auth"
    plugin_hints: ["idor_check"]
  - title: "Forged Feedback"
    severity: "high"
    category: "auth"
    plugin_hints: ["idor_check"]
  - title: "Product Tampering"
    severity: "high"
    category: "auth"
    plugin_hints: ["param_tampering"]
  - title: "Confidential Document"
    severity: "high"
    category: "config"
    plugin_hints: ["dir_brute", "git_exposure"]
  - title: "Forgotten Developer Backup"
    severity: "high"
    category: "config"
    plugin_hints: ["dir_brute"]
  - title: "Exposed Metrics"
    severity: "medium"
    category: "config"
    plugin_hints: ["dir_brute"]
  - title: "Error Handling Disclosure"
    severity: "medium"
    category: "config"
    plugin_hints: ["http_headers"]
  - title: "Deprecated Interface"
    severity: "medium"
    category: "config"
    plugin_hints: ["tech_detect"]
  - title: "Known Vulnerable Component"
    severity: "high"
    category: "config"
    plugin_hints: ["version_detect"]
  - title: "Weak Crypto Algorithm"
    severity: "medium"
    category: "crypto"
    plugin_hints: ["prng_crack"]
  - title: "Forged Coupon"
    severity: "high"
    category: "crypto"
    plugin_hints: ["param_tampering"]
  - title: "Zero Stars Rating"
    severity: "medium"
    category: "injection"
    plugin_hints: ["param_tampering"]
  - title: "Negative Quantity Order"
    severity: "high"
    category: "injection"
    plugin_hints: ["param_tampering"]
  - title: "Upload Size Bypass"
    severity: "medium"
    category: "upload"
    plugin_hints: ["file_upload_bypass"]
  - title: "Allowlist Bypass Redirect"
    severity: "medium"
    category: "config"
    plugin_hints: ["open_redirect"]
  - title: "CAPTCHA Bypass"
    severity: "medium"
    category: "auth"
    plugin_hints: ["csrf_check"]
  - title: "Score Board Discovery"
    severity: "low"
    category: "config"
    plugin_hints: ["dir_brute"]
